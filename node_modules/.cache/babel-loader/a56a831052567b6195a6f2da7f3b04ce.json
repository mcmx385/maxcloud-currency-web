{"ast":null,"code":"var _jsxFileName = \"D:\\\\Files\\\\OneDrive\\\\code\\\\lang\\\\react\\\\currency\\\\src\\\\pages\\\\Currency.js\";\nimport Nav from '../components/Nav';\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { Line } from 'react-chartjs-2';\nimport { pastDate, todayDate } from '../libraries/datetime';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass Currency extends Component {\n  constructor(props) {\n    super(props);\n\n    this.renderAvailable = () => {\n      return Object.keys(this.state.available).map((key, id) => {\n        return /*#__PURE__*/_jsxDEV(\"option\", {\n          value: key,\n          children: [key, \" (\", this.state.available[key], \")\"]\n        }, id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 41,\n          columnNumber: 9\n        }, this);\n      });\n      this.onSubmit();\n    };\n\n    this.setBase = base => {\n      this.setState({\n        base\n      });\n      this.updateRate();\n    };\n\n    this.setTarget = target => {\n      this.setState({\n        target\n      });\n      this.updateRate();\n    };\n\n    this.setAmount = amount => {\n      if (amount !== '' && amount >= 0) {\n        this.setState({\n          amount: parseInt(amount)\n        });\n      } else {\n        this.setState({\n          amount: ''\n        });\n      }\n    };\n\n    this.onSubmit = e => {\n      if (e) {\n        e.preventDefault();\n      }\n\n      this.updateRate();\n      console.log(this.state.rate);\n      console.log(this.state.amount);\n      console.log(this.state.rate * this.state.amount);\n      this.setState({\n        result: this.state.rate * this.state.amount\n      });\n    };\n\n    this.updateRate = () => {\n      const url = 'https://api.exchangerate.host/convert?from=' + this.state.base + '&to=' + this.state.target;\n      fetch(url).then(response => response.json()).then(result => {\n        this.setState({\n          rate: result.info.rate\n        });\n      });\n      this.getRateTS();\n    };\n\n    this.getRateTS = () => {\n      const url = 'https://api.exchangerate.host/timeseries?start_date=' + this.state.start_date + '&end_date=' + this.state.end_date + '&base=' + this.state.base + '&symbols=' + this.state.target;\n      fetch(url).then(response => response.json()).then(result => {\n        this.setState({\n          timeSeries: result.rates\n        });\n      });\n    };\n\n    this.showRateTS = () => {\n      const datetime = Object.keys(this.state.timeSeries);\n      const daterate = Object.values(this.state.timeSeries);\n      var arr = [];\n      datetime.map((key, id) => {\n        arr.push(daterate[id][this.state.target]);\n      });\n      const data = {\n        labels: datetime,\n        datasets: [{\n          label: 'Exchange Rate from ' + this.state.base + ' to ' + this.state.target + ' in Past ' + this.state.show_days + ' Days',\n          data: arr,\n          fill: false,\n          backgroundColor: 'rgb(255, 99, 132)',\n          borderColor: 'rgba(255, 99, 132, 0.2)'\n        }]\n      };\n      const options = {\n        scales: {\n          yAxes: [{\n            ticks: {\n              beginAtZero: true\n            }\n          }]\n        }\n      };\n      return /*#__PURE__*/_jsxDEV(Line, {\n        data: data,\n        options: options\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 12\n      }, this);\n    };\n\n    this.state = {\n      available: [],\n      base: 'HKD',\n      target: 'USD',\n      rate: 0,\n      timeSeries: [],\n      show_days: 30,\n      start_date: pastDate(30),\n      end_date: todayDate(),\n      amount: 888,\n      result: 0,\n      isLoading: false,\n      isError: false\n    };\n  }\n\n  async componentDidMount() {\n    this.setState({\n      isLoading: true\n    });\n    const response = await fetch('https://openexchangerates.org/api/currencies.json');\n\n    if (response.ok) {\n      const available = await response.json();\n      this.setState({\n        available,\n        isLoading: false\n      });\n    } else {\n      this.setState({\n        isError: true,\n        isLoading: false\n      });\n    }\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(Nav, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"container py-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"Currency Converter\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n          action: \"\",\n          onSubmit: this.onSubmit,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"row\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col-6\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"form-group\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  htmlFor: \"\",\n                  children: \"Base Currency\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 152,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n                  name: \"type\",\n                  id: \"\",\n                  className: \"form-control\",\n                  value: this.state.base,\n                  onChange: e => this.setBase(e.target.value),\n                  children: this.renderAvailable()\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 153,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 151,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 150,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col-6\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"form-group\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  htmlFor: \"\",\n                  children: \"Target Currency\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 166,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n                  name: \"type\",\n                  id: \"\",\n                  className: \"form-control\",\n                  value: this.state.target,\n                  onChange: e => this.setTarget(e.target.value),\n                  children: this.renderAvailable()\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 167,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 165,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 164,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col\",\n              children: [\"Current Rate: \", this.state.rate]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 178,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 149,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"row\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"form-group\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  htmlFor: \"\",\n                  children: \"Amount (From)\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 183,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"number\",\n                  className: \"form-control\",\n                  value: this.state.amount,\n                  onChange: e => this.setAmount(e.target.value)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 184,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 182,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 181,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"form-group\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  htmlFor: \"\",\n                  children: \"Amount (To)\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 194,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"number\",\n                  className: \"form-control\",\n                  value: this.state.result,\n                  disabled: true\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 195,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 193,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 192,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 180,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn btn-success\",\n            type: \"submit\",\n            children: \"Convert\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 204,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 148,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 208,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"Past Exchange Rate\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 209,\n          columnNumber: 11\n        }, this), this.showRateTS()]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nCurrency.propTypes = {\n  amount: PropTypes.number\n};\nexport default Currency;","map":{"version":3,"sources":["D:/Files/OneDrive/code/lang/react/currency/src/pages/Currency.js"],"names":["Nav","React","Component","PropTypes","Line","pastDate","todayDate","Currency","constructor","props","renderAvailable","Object","keys","state","available","map","key","id","onSubmit","setBase","base","setState","updateRate","setTarget","target","setAmount","amount","parseInt","e","preventDefault","console","log","rate","result","url","fetch","then","response","json","info","getRateTS","start_date","end_date","timeSeries","rates","showRateTS","datetime","daterate","values","arr","push","data","labels","datasets","label","show_days","fill","backgroundColor","borderColor","options","scales","yAxes","ticks","beginAtZero","isLoading","isError","componentDidMount","ok","render","value","propTypes","number"],"mappings":"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","sourcesContent":["import Nav from '../components/Nav'\nimport React, { Component } from 'react'\nimport PropTypes from 'prop-types'\nimport { Line } from 'react-chartjs-2'\nimport { pastDate, todayDate } from '../libraries/datetime'\n\nclass Currency extends Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      available: [],\n      base: 'HKD',\n      target: 'USD',\n      rate: 0,\n      timeSeries: [],\n      show_days: 30,\n      start_date: pastDate(30),\n      end_date: todayDate(),\n      amount: 888,\n      result: 0,\n      isLoading: false,\n      isError: false,\n    }\n  }\n\n  async componentDidMount() {\n    this.setState({ isLoading: true })\n    const response = await fetch(\n      'https://openexchangerates.org/api/currencies.json',\n    )\n    if (response.ok) {\n      const available = await response.json()\n      this.setState({ available, isLoading: false })\n    } else {\n      this.setState({ isError: true, isLoading: false })\n    }\n  }\n  renderAvailable = () => {\n    return Object.keys(this.state.available).map((key, id) => {\n      return (\n        <option value={key} key={id}>\n          {key} ({this.state.available[key]})\n        </option>\n      )\n    })\n    this.onSubmit()\n  }\n  setBase = (base) => {\n    this.setState({ base })\n    this.updateRate()\n  }\n  setTarget = (target) => {\n    this.setState({ target })\n    this.updateRate()\n  }\n  setAmount = (amount) => {\n    if (amount !== '' && amount >= 0) {\n      this.setState({ amount: parseInt(amount) })\n    } else {\n      this.setState({ amount: '' })\n    }\n  }\n  onSubmit = (e) => {\n    if (e) {\n      e.preventDefault()\n    }\n    this.updateRate()\n    console.log(this.state.rate)\n    console.log(this.state.amount)\n    console.log(this.state.rate * this.state.amount)\n    this.setState({ result: this.state.rate * this.state.amount })\n  }\n  updateRate = () => {\n    const url =\n      'https://api.exchangerate.host/convert?from=' +\n      this.state.base +\n      '&to=' +\n      this.state.target\n    fetch(url)\n      .then((response) => response.json())\n      .then((result) => {\n        this.setState({ rate: result.info.rate })\n      })\n    this.getRateTS()\n  }\n  getRateTS = () => {\n    const url =\n      'https://api.exchangerate.host/timeseries?start_date=' +\n      this.state.start_date +\n      '&end_date=' +\n      this.state.end_date +\n      '&base=' +\n      this.state.base +\n      '&symbols=' +\n      this.state.target\n    fetch(url)\n      .then((response) => response.json())\n      .then((result) => {\n        this.setState({ timeSeries: result.rates })\n      })\n  }\n  showRateTS = () => {\n    const datetime = Object.keys(this.state.timeSeries)\n    const daterate = Object.values(this.state.timeSeries)\n    var arr = []\n    datetime.map((key, id) => {\n      arr.push(daterate[id][this.state.target])\n    })\n    const data = {\n      labels: datetime,\n      datasets: [\n        {\n          label:\n            'Exchange Rate from ' +\n            this.state.base +\n            ' to ' +\n            this.state.target +\n            ' in Past ' +\n            this.state.show_days +\n            ' Days',\n          data: arr,\n          fill: false,\n          backgroundColor: 'rgb(255, 99, 132)',\n          borderColor: 'rgba(255, 99, 132, 0.2)',\n        },\n      ],\n    }\n    const options = {\n      scales: {\n        yAxes: [\n          {\n            ticks: {\n              beginAtZero: true,\n            },\n          },\n        ],\n      },\n    }\n    return <Line data={data} options={options} />\n  }\n\n  render() {\n    return (\n      <div>\n        <Nav />\n        <div className=\"container py-4\">\n          <h3>Currency Converter</h3>\n          <form action=\"\" onSubmit={this.onSubmit}>\n            <div className=\"row\">\n              <div className=\"col-6\">\n                <div className=\"form-group\">\n                  <label htmlFor=\"\">Base Currency</label>\n                  <select\n                    name=\"type\"\n                    id=\"\"\n                    className=\"form-control\"\n                    value={this.state.base}\n                    onChange={(e) => this.setBase(e.target.value)}\n                  >\n                    {this.renderAvailable()}\n                  </select>\n                </div>\n              </div>\n              <div className=\"col-6\">\n                <div className=\"form-group\">\n                  <label htmlFor=\"\">Target Currency</label>\n                  <select\n                    name=\"type\"\n                    id=\"\"\n                    className=\"form-control\"\n                    value={this.state.target}\n                    onChange={(e) => this.setTarget(e.target.value)}\n                  >\n                    {this.renderAvailable()}\n                  </select>\n                </div>\n              </div>\n              <div className=\"col\">Current Rate: {this.state.rate}</div>\n            </div>\n            <div className=\"row\">\n              <div className=\"col\">\n                <div className=\"form-group\">\n                  <label htmlFor=\"\">Amount (From)</label>\n                  <input\n                    type=\"number\"\n                    className=\"form-control\"\n                    value={this.state.amount}\n                    onChange={(e) => this.setAmount(e.target.value)}\n                  />\n                </div>\n              </div>\n              <div className=\"col\">\n                <div className=\"form-group\">\n                  <label htmlFor=\"\">Amount (To)</label>\n                  <input\n                    type=\"number\"\n                    className=\"form-control\"\n                    value={this.state.result}\n                    disabled\n                  />\n                </div>\n              </div>\n            </div>\n            <button className=\"btn btn-success\" type=\"submit\">\n              Convert\n            </button>\n          </form>\n          <hr />\n          <h3>Past Exchange Rate</h3>\n          {this.showRateTS()}\n        </div>\n      </div>\n    )\n  }\n}\nCurrency.propTypes = {\n  amount: PropTypes.number,\n}\n\nexport default Currency\n"]},"metadata":{},"sourceType":"module"}