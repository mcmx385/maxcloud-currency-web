{"ast":null,"code":"var _jsxFileName = \"D:\\\\Files\\\\Coding\\\\react\\\\reactjs-currency-converter\\\\src\\\\pages\\\\Currency.js\";\nimport Nav from '../components/Nav';\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { Line } from 'react-chartjs-2';\nimport { pastDate, todayDate } from '../libraries/datetime';\nimport { Button } from '../components/Button';\nimport Dropdown from '../components/Dropdown';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass Currency extends Component {\n  // Setup\n  constructor(props) {\n    super(props);\n\n    this.renderAvailable = () => {\n      return Object.keys(this.state.available).map((key, id) => {\n        return /*#__PURE__*/_jsxDEV(\"option\", {\n          value: key,\n          children: [key, \"(\", this.state.available[key], \")\"]\n        }, id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 45,\n          columnNumber: 9\n        }, this);\n      });\n    };\n\n    this.setBase = base => {\n      this.setState({\n        isLoading: true\n      });\n      this.setState({\n        base: base\n      }, () => {\n        this.updateRate();\n        this.setState({\n          isLoading: false\n        });\n      });\n    };\n\n    this.setTarget = target => {\n      this.setState({\n        isLoading: true\n      });\n      this.setState({\n        target: target\n      }, () => {\n        this.updateRate();\n        this.setState({\n          isLoading: false\n        });\n      });\n    };\n\n    this.setAmount = amount => {\n      this.setState({\n        isLoading: true\n      });\n      this.setState({\n        amount: amount !== '' ? parseInt(amount) : ''\n      }, () => this.convert(), this.setState({\n        isLoading: false\n      }));\n    };\n\n    this.setShowDays = days => {\n      this.setState({\n        isLoading: true\n      });\n      const start_date = pastDate(days);\n      this.setState({\n        show_days: days,\n        start_date\n      }, () => {\n        this.getRateTS();\n        this.setState({\n          isLoading: false\n        });\n      });\n    };\n\n    this.convert = () => {\n      this.setState({\n        isLoading: true\n      });\n      this.setState({\n        result: this.state.rate * this.state.amount\n      });\n      this.setState({\n        isLoading: false\n      });\n    };\n\n    this.onSubmit = e => {\n      this.setState({\n        isLoading: true\n      });\n\n      if (e) {\n        e.preventDefault();\n      }\n\n      this.convert();\n      this.setState({\n        isLoading: false\n      });\n    };\n\n    this.getRateTS = () => {\n      this.setState({\n        isLoading: true\n      });\n      const url = 'https://api.exchangerate.host/timeseries?start_date=' + this.state.start_date + '&end_date=' + this.state.end_date + '&base=' + this.state.base + '&symbols=' + this.state.target;\n      fetch(url).then(response => response.json()).then(result => {\n        this.setState({\n          timeSeries: result.rates\n        }, () => this.updateChart());\n      });\n      this.setState({\n        isLoading: false\n      });\n    };\n\n    this.updateChart = () => {\n      this.setState({\n        isLoading: true\n      });\n      const datetime = Object.keys(this.state.timeSeries);\n      const daterate = Object.values(this.state.timeSeries);\n      var arr = [];\n      datetime.map((key, id) => {\n        return arr.push(daterate[id][this.state.target]);\n      });\n      this.setState({\n        chartData: arr,\n        chartLabel: datetime\n      });\n      this.setState({\n        isLoading: false\n      });\n    };\n\n    this.state = {\n      available: [],\n      base: 'HKD',\n      target: 'USD',\n      rate: 0,\n      timeSeries: [],\n      show_days: 30,\n      start_date: pastDate(30),\n      end_date: todayDate(),\n      amount: 888,\n      result: 0,\n      isLoading: false,\n      isError: false,\n      chartData: [],\n      chartLabel: []\n    };\n  }\n\n  async componentDidMount() {\n    this.setState({\n      isLoading: true\n    });\n    const response = await fetch('https://openexchangerates.org/api/currencies.json');\n\n    if (response.ok) {\n      const available = await response.json();\n      this.setState({\n        available,\n        isLoading: false\n      }, () => this.updateRate());\n    } else {\n      this.setState({\n        isError: true,\n        isLoading: false\n      });\n    }\n  }\n\n  async updateRate() {\n    this.setState({\n      isLoading: true\n    });\n    const url = 'https://api.exchangerate.host/convert?from=' + this.state.base + '&to=' + this.state.target;\n    const response = await fetch(url);\n\n    if (response.ok) {\n      const result = await response.json();\n      this.setState({\n        rate: result.result\n      }, () => {\n        this.convert();\n        this.getRateTS();\n      });\n    }\n\n    this.setState({\n      isLoading: false\n    });\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(Nav, {\n        title: \"CurrencyApp\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"container p-4\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"card p-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \" Currency Converter \"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 151,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n            action: \"\",\n            onSubmit: this.onSubmit,\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"row\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"col-6\",\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"form-group\",\n                  children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                    htmlFor: \"\",\n                    children: \" Base Currency \"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 156,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(Dropdown, {\n                    name: \"type\",\n                    selected: this.state.base,\n                    onChange: this.setBase,\n                    data: this.state.available\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 157,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 155,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 154,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"col-6\",\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"form-group\",\n                  children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                    htmlFor: \"\",\n                    children: \" Target Currency \"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 167,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(Dropdown, {\n                    name: \"type\",\n                    selected: this.state.target,\n                    onChange: this.setTarget,\n                    data: this.state.available\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 168,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 166,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 165,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"col text-center py-2\",\n                children: [\"Current Rate:\", this.state.rate && !this.state.isLoading ? this.state.rate : 'Loading...']\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 176,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 153,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"row\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"col\",\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"form-group\",\n                  children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                    htmlFor: \"\",\n                    children: \" Amount(From) \"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 186,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                    type: \"number\",\n                    className: \"form-control\",\n                    value: this.state.amount,\n                    onChange: e => this.setAmount(e.target.value)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 187,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 185,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 184,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"col\",\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"form-group\",\n                  children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                    htmlFor: \"\",\n                    children: \" Amount(To) \"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 197,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                    type: \"number\",\n                    className: \"form-control\",\n                    value: this.state.result,\n                    disabled: true\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 198,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 196,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 195,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 183,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Button, {\n              bgcolor: \"success\",\n              submit: true,\n              text: \"Convert\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 207,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 152,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 209,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"row\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col\",\n              children: /*#__PURE__*/_jsxDEV(\"h3\", {\n                children: \" Past Exchange Rate \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 212,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 211,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"input-group mb-3\",\n                children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"number\",\n                  className: \"form-control\",\n                  value: this.state.show_days,\n                  onChange: e => this.setShowDays(e.target.value)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 216,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"input-group-text\",\n                  id: \"basic-addon2\",\n                  children: \"Days\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 222,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 215,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 214,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 210,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Line, {\n            data: {\n              labels: this.state.chartLabel,\n              datasets: [{\n                label: 'Exchange Rate from ' + this.state.base + ' to ' + this.state.target + ' in Past ' + this.state.show_days + ' Days',\n                data: this.state.chartData,\n                fill: false,\n                backgroundColor: 'rgb(255, 99, 132)',\n                borderColor: 'rgba(255, 99, 132, 0.2)'\n              }]\n            },\n            options: {\n              scales: {\n                yAxes: [{\n                  ticks: {\n                    beginAtZero: true\n                  }\n                }]\n              }\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 228,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nCurrency.propTypes = {\n  amount: PropTypes.number\n};\nexport default Currency;","map":{"version":3,"sources":["D:/Files/Coding/react/reactjs-currency-converter/src/pages/Currency.js"],"names":["Nav","React","Component","PropTypes","Line","pastDate","todayDate","Button","Dropdown","Currency","constructor","props","renderAvailable","Object","keys","state","available","map","key","id","setBase","base","setState","isLoading","updateRate","setTarget","target","setAmount","amount","parseInt","convert","setShowDays","days","start_date","show_days","getRateTS","result","rate","onSubmit","e","preventDefault","url","end_date","fetch","then","response","json","timeSeries","rates","updateChart","datetime","daterate","values","arr","push","chartData","chartLabel","isError","componentDidMount","ok","render","value","labels","datasets","label","data","fill","backgroundColor","borderColor","scales","yAxes","ticks","beginAtZero","propTypes","number"],"mappings":"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","sourcesContent":["import Nav from '../components/Nav'\nimport React, { Component } from 'react'\nimport PropTypes from 'prop-types'\nimport { Line } from 'react-chartjs-2'\nimport { pastDate, todayDate } from '../libraries/datetime'\nimport { Button } from '../components/Button'\nimport Dropdown from '../components/Dropdown'\n\nclass Currency extends Component {\n  // Setup\n  constructor(props) {\n    super(props)\n    this.state = {\n      available: [],\n      base: 'HKD',\n      target: 'USD',\n      rate: 0,\n      timeSeries: [],\n      show_days: 30,\n      start_date: pastDate(30),\n      end_date: todayDate(),\n      amount: 888,\n      result: 0,\n      isLoading: false,\n      isError: false,\n      chartData: [],\n      chartLabel: [],\n    }\n  }\n  async componentDidMount() {\n    this.setState({ isLoading: true })\n    const response = await fetch(\n      'https://openexchangerates.org/api/currencies.json',\n    )\n    if (response.ok) {\n      const available = await response.json()\n      this.setState({ available, isLoading: false }, () => this.updateRate())\n    } else {\n      this.setState({ isError: true, isLoading: false })\n    }\n  }\n  renderAvailable = () => {\n    return Object.keys(this.state.available).map((key, id) => {\n      return (\n        <option value={key} key={id}>\n          {key}({this.state.available[key]})\n        </option>\n      )\n    })\n  }\n\n  // Edit fields\n  setBase = (base) => {\n    this.setState({ isLoading: true })\n    this.setState({ base: base }, () => {\n      this.updateRate()\n      this.setState({ isLoading: false })\n    })\n  }\n  setTarget = (target) => {\n    this.setState({ isLoading: true })\n    this.setState({ target: target }, () => {\n      this.updateRate()\n      this.setState({ isLoading: false })\n    })\n  }\n  setAmount = (amount) => {\n    this.setState({ isLoading: true })\n    this.setState(\n      { amount: amount !== '' ? parseInt(amount) : '' },\n      () => this.convert(),\n      this.setState({ isLoading: false }),\n    )\n  }\n  setShowDays = (days) => {\n    this.setState({ isLoading: true })\n    const start_date = pastDate(days)\n    this.setState({ show_days: days, start_date }, () => {\n      this.getRateTS()\n      this.setState({ isLoading: false })\n    })\n  }\n\n  // Update actions\n  convert = () => {\n    this.setState({ isLoading: true })\n    this.setState({ result: this.state.rate * this.state.amount })\n    this.setState({ isLoading: false })\n  }\n  onSubmit = (e) => {\n    this.setState({ isLoading: true })\n    if (e) {\n      e.preventDefault()\n    }\n    this.convert()\n    this.setState({ isLoading: false })\n  }\n  async updateRate() {\n    this.setState({ isLoading: true })\n    const url =\n      'https://api.exchangerate.host/convert?from=' +\n      this.state.base +\n      '&to=' +\n      this.state.target\n    const response = await fetch(url)\n    if (response.ok) {\n      const result = await response.json()\n      this.setState({ rate: result.result }, () => {\n        this.convert()\n        this.getRateTS()\n      })\n    }\n    this.setState({ isLoading: false })\n  }\n  getRateTS = () => {\n    this.setState({ isLoading: true })\n    const url =\n      'https://api.exchangerate.host/timeseries?start_date=' +\n      this.state.start_date +\n      '&end_date=' +\n      this.state.end_date +\n      '&base=' +\n      this.state.base +\n      '&symbols=' +\n      this.state.target\n    fetch(url)\n      .then((response) => response.json())\n      .then((result) => {\n        this.setState({ timeSeries: result.rates }, () => this.updateChart())\n      })\n    this.setState({ isLoading: false })\n  }\n  updateChart = () => {\n    this.setState({ isLoading: true })\n    const datetime = Object.keys(this.state.timeSeries)\n    const daterate = Object.values(this.state.timeSeries)\n    var arr = []\n    datetime.map((key, id) => {\n      return arr.push(daterate[id][this.state.target])\n    })\n    this.setState({ chartData: arr, chartLabel: datetime })\n    this.setState({ isLoading: false })\n  }\n\n  render() {\n    return (\n      <div>\n        <Nav title=\"CurrencyApp\" />\n        <div className=\"container p-4\">\n          <div className=\"card p-4\">\n            <h3> Currency Converter </h3>\n            <form action=\"\" onSubmit={this.onSubmit}>\n              <div className=\"row\">\n                <div className=\"col-6\">\n                  <div className=\"form-group\">\n                    <label htmlFor=\"\"> Base Currency </label>\n                    <Dropdown\n                      name=\"type\"\n                      selected={this.state.base}\n                      onChange={this.setBase}\n                      data={this.state.available}\n                    />\n                  </div>\n                </div>\n                <div className=\"col-6\">\n                  <div className=\"form-group\">\n                    <label htmlFor=\"\"> Target Currency </label>\n                    <Dropdown\n                      name=\"type\"\n                      selected={this.state.target}\n                      onChange={this.setTarget}\n                      data={this.state.available}\n                    />\n                  </div>\n                </div>\n                <div className=\"col text-center py-2\">\n                  Current Rate:\n                  {this.state.rate && !this.state.isLoading\n                    ? this.state.rate\n                    : 'Loading...'}\n                </div>\n              </div>\n              <div className=\"row\">\n                <div className=\"col\">\n                  <div className=\"form-group\">\n                    <label htmlFor=\"\"> Amount(From) </label>\n                    <input\n                      type=\"number\"\n                      className=\"form-control\"\n                      value={this.state.amount}\n                      onChange={(e) => this.setAmount(e.target.value)}\n                    />\n                  </div>\n                </div>\n                <div className=\"col\">\n                  <div className=\"form-group\">\n                    <label htmlFor=\"\"> Amount(To) </label>\n                    <input\n                      type=\"number\"\n                      className=\"form-control\"\n                      value={this.state.result}\n                      disabled\n                    />\n                  </div>\n                </div>\n              </div>\n              <Button bgcolor=\"success\" submit={true} text=\"Convert\" />\n            </form>\n            <hr />\n            <div className=\"row\">\n              <div className=\"col\">\n                <h3> Past Exchange Rate </h3>\n              </div>\n              <div className=\"col\">\n                <div className=\"input-group mb-3\">\n                  <input\n                    type=\"number\"\n                    className=\"form-control\"\n                    value={this.state.show_days}\n                    onChange={(e) => this.setShowDays(e.target.value)}\n                  />\n                  <span className=\"input-group-text\" id=\"basic-addon2\">\n                    Days\n                  </span>\n                </div>\n              </div>\n            </div>\n            <Line\n              data={{\n                labels: this.state.chartLabel,\n                datasets: [\n                  {\n                    label:\n                      'Exchange Rate from ' +\n                      this.state.base +\n                      ' to ' +\n                      this.state.target +\n                      ' in Past ' +\n                      this.state.show_days +\n                      ' Days',\n                    data: this.state.chartData,\n                    fill: false,\n                    backgroundColor: 'rgb(255, 99, 132)',\n                    borderColor: 'rgba(255, 99, 132, 0.2)',\n                  },\n                ],\n              }}\n              options={{\n                scales: {\n                  yAxes: [\n                    {\n                      ticks: {\n                        beginAtZero: true,\n                      },\n                    },\n                  ],\n                },\n              }}\n            />\n          </div>\n        </div>\n      </div>\n    )\n  }\n}\nCurrency.propTypes = {\n  amount: PropTypes.number,\n}\n\nexport default Currency\n"]},"metadata":{},"sourceType":"module"}