{"ast":null,"code":"var _jsxFileName = \"D:\\\\Files\\\\OneDrive\\\\code\\\\lang\\\\react\\\\currency\\\\src\\\\pages\\\\Currency.js\";\nimport Nav from '../components/Nav';\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { Line } from 'react-chartjs-2';\nimport { todayDate } from '../libraries/datetime';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass Currency extends Component {\n  constructor(props) {\n    console.log(todayDate());\n    super(props);\n\n    this.renderAvailable = () => {\n      return Object.keys(this.state.available).map((key, id) => {\n        return /*#__PURE__*/_jsxDEV(\"option\", {\n          value: key,\n          children: [key, \" (\", this.state.available[key], \")\"]\n        }, id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 42,\n          columnNumber: 9\n        }, this);\n      });\n    };\n\n    this.setBase = base => {\n      this.setState({\n        base\n      });\n      this.updateRate();\n    };\n\n    this.setTarget = target => {\n      this.setState({\n        target\n      });\n      this.updateRate();\n    };\n\n    this.setAmount = amount => {\n      if (amount !== '' && amount >= 0) {\n        this.setState({\n          amount: parseInt(amount)\n        });\n      } else {\n        this.setState({\n          amount: ''\n        });\n      }\n    };\n\n    this.onSubmit = e => {\n      e.preventDefault();\n      this.updateRate();\n      this.setState({\n        result: this.state.rate * this.state.amount\n      });\n    };\n\n    this.updateRate = () => {\n      const url = 'https://api.exchangerate.host/convert?from=' + this.state.base + '&to=' + this.state.target;\n      fetch(url).then(response => response.json()).then(result => {\n        this.setState({\n          rate: result.info.rate\n        });\n      });\n      this.getRateTS();\n    };\n\n    this.getRateTS = () => {\n      const url = 'https://api.exchangerate.host/timeseries?start_date=' + this.state.start_date + '&end_date=' + this.state.end_date + '&base=' + this.state.base + '&symbols=' + this.state.target;\n      console.log(url);\n      fetch(url).then(response => response.json()).then(result => {\n        console.log(result);\n        this.setState({\n          timeSeries: result.rates\n        });\n      });\n    };\n\n    this.showRateTS = () => {\n      const datetime = Object.keys(this.state.timeSeries);\n      const daterate = Object.values(this.state.timeSeries);\n      var arr = [];\n      datetime.map((key, id) => {\n        console.log(daterate[id]);\n        arr.push(daterate[id][this.state.target]);\n      });\n      const data = {\n        labels: datetime,\n        datasets: [{\n          label: 'Exchange Rate from ' + this.state.base + ' to ' + this.state.target + ' in Past 30 Days',\n          data: arr,\n          fill: false,\n          backgroundColor: 'rgb(255, 99, 132)',\n          borderColor: 'rgba(255, 99, 132, 0.2)'\n        }]\n      };\n      const options = {\n        scales: {\n          yAxes: [{\n            ticks: {\n              beginAtZero: true\n            }\n          }]\n        }\n      };\n      return /*#__PURE__*/_jsxDEV(Line, {\n        data: data,\n        options: options\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 12\n      }, this);\n    };\n\n    this.state = {\n      available: [],\n      base: 'HKD',\n      target: 'USD',\n      rate: 0,\n      timeSeries: [],\n      start_date: '2021-01-01',\n      end_date: todayDate(),\n      amount: 0,\n      result: 0,\n      isLoading: false,\n      isError: false\n    };\n  }\n\n  async componentDidMount() {\n    this.setState({\n      isLoading: true\n    });\n    const response = await fetch('https://openexchangerates.org/api/currencies.json');\n\n    if (response.ok) {\n      const available = await response.json();\n      this.setState({\n        available,\n        isLoading: false\n      });\n    } else {\n      this.setState({\n        isError: true,\n        isLoading: false\n      });\n    }\n\n    this.updateRate();\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(Nav, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"container\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"Currency Converter\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 143,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n          action: \"\",\n          onSubmit: this.onSubmit,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"row\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col-6\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"form-group\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  htmlFor: \"\",\n                  children: \"Base Currency\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 148,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n                  name: \"type\",\n                  id: \"\",\n                  className: \"form-control\",\n                  value: this.state.base,\n                  onChange: e => this.setBase(e.target.value),\n                  children: this.renderAvailable()\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 149,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 147,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 146,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col-6\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"form-group\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  htmlFor: \"\",\n                  children: \"Target Currency\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 162,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n                  name: \"type\",\n                  id: \"\",\n                  className: \"form-control\",\n                  value: this.state.target,\n                  onChange: e => this.setTarget(e.target.value),\n                  children: this.renderAvailable()\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 163,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 161,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 160,\n              columnNumber: 15\n            }, this), this.showRateTS(), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col\",\n              children: [\"Current Rate: \", this.state.rate]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 175,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 145,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"row\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"form-group\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  htmlFor: \"\",\n                  children: \"Amount (From)\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 180,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"number\",\n                  className: \"form-control\",\n                  value: this.state.amount,\n                  onChange: e => this.setAmount(e.target.value)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 181,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 179,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 178,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"form-group\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  htmlFor: \"\",\n                  children: \"Amount (To)\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 191,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"number\",\n                  className: \"form-control\",\n                  value: this.state.result,\n                  disabled: true\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 192,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 190,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 189,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 177,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn btn-success\",\n            type: \"submit\",\n            children: \"Convert\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 201,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 144,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nCurrency.propTypes = {\n  amount: PropTypes.number\n};\nexport default Currency;","map":{"version":3,"sources":["D:/Files/OneDrive/code/lang/react/currency/src/pages/Currency.js"],"names":["Nav","React","Component","PropTypes","Line","todayDate","Currency","constructor","props","console","log","renderAvailable","Object","keys","state","available","map","key","id","setBase","base","setState","updateRate","setTarget","target","setAmount","amount","parseInt","onSubmit","e","preventDefault","result","rate","url","fetch","then","response","json","info","getRateTS","start_date","end_date","timeSeries","rates","showRateTS","datetime","daterate","values","arr","push","data","labels","datasets","label","fill","backgroundColor","borderColor","options","scales","yAxes","ticks","beginAtZero","isLoading","isError","componentDidMount","ok","render","value","propTypes","number"],"mappings":"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","sourcesContent":["import Nav from '../components/Nav'\nimport React, { Component } from 'react'\nimport PropTypes from 'prop-types'\nimport { Line } from 'react-chartjs-2'\nimport { todayDate } from '../libraries/datetime'\n\nclass Currency extends Component {\n  constructor(props) {\n    console.log(todayDate())\n    super(props)\n    this.state = {\n      available: [],\n      base: 'HKD',\n      target: 'USD',\n      rate: 0,\n      timeSeries: [],\n      start_date: '2021-01-01',\n      end_date: todayDate(),\n      amount: 0,\n      result: 0,\n      isLoading: false,\n      isError: false,\n    }\n  }\n\n  async componentDidMount() {\n    this.setState({ isLoading: true })\n    const response = await fetch(\n      'https://openexchangerates.org/api/currencies.json',\n    )\n    if (response.ok) {\n      const available = await response.json()\n      this.setState({ available, isLoading: false })\n    } else {\n      this.setState({ isError: true, isLoading: false })\n    }\n    this.updateRate()\n  }\n  renderAvailable = () => {\n    return Object.keys(this.state.available).map((key, id) => {\n      return (\n        <option value={key} key={id}>\n          {key} ({this.state.available[key]})\n        </option>\n      )\n    })\n  }\n  setBase = (base) => {\n    this.setState({ base })\n    this.updateRate()\n  }\n  setTarget = (target) => {\n    this.setState({ target })\n    this.updateRate()\n  }\n  setAmount = (amount) => {\n    if (amount !== '' && amount >= 0) {\n      this.setState({ amount: parseInt(amount) })\n    } else {\n      this.setState({ amount: '' })\n    }\n  }\n  onSubmit = (e) => {\n    e.preventDefault()\n    this.updateRate()\n    this.setState({ result: this.state.rate * this.state.amount })\n  }\n  updateRate = () => {\n    const url =\n      'https://api.exchangerate.host/convert?from=' +\n      this.state.base +\n      '&to=' +\n      this.state.target\n    fetch(url)\n      .then((response) => response.json())\n      .then((result) => {\n        this.setState({ rate: result.info.rate })\n      })\n    this.getRateTS()\n  }\n  getRateTS = () => {\n    const url =\n      'https://api.exchangerate.host/timeseries?start_date=' +\n      this.state.start_date +\n      '&end_date=' +\n      this.state.end_date +\n      '&base=' +\n      this.state.base +\n      '&symbols=' +\n      this.state.target\n    console.log(url)\n    fetch(url)\n      .then((response) => response.json())\n      .then((result) => {\n        console.log(result)\n        this.setState({ timeSeries: result.rates })\n      })\n  }\n  showRateTS = () => {\n    const datetime = Object.keys(this.state.timeSeries)\n    const daterate = Object.values(this.state.timeSeries)\n    var arr = []\n    datetime.map((key, id) => {\n      console.log(daterate[id])\n      arr.push(daterate[id][this.state.target])\n    })\n    const data = {\n      labels: datetime,\n      datasets: [\n        {\n          label:\n            'Exchange Rate from ' +\n            this.state.base +\n            ' to ' +\n            this.state.target +\n            ' in Past 30 Days',\n          data: arr,\n          fill: false,\n          backgroundColor: 'rgb(255, 99, 132)',\n          borderColor: 'rgba(255, 99, 132, 0.2)',\n        },\n      ],\n    }\n    const options = {\n      scales: {\n        yAxes: [\n          {\n            ticks: {\n              beginAtZero: true,\n            },\n          },\n        ],\n      },\n    }\n    return <Line data={data} options={options} />\n  }\n\n  render() {\n    return (\n      <div>\n        <Nav />\n        <div className=\"container\">\n          <h3>Currency Converter</h3>\n          <form action=\"\" onSubmit={this.onSubmit}>\n            <div className=\"row\">\n              <div className=\"col-6\">\n                <div className=\"form-group\">\n                  <label htmlFor=\"\">Base Currency</label>\n                  <select\n                    name=\"type\"\n                    id=\"\"\n                    className=\"form-control\"\n                    value={this.state.base}\n                    onChange={(e) => this.setBase(e.target.value)}\n                  >\n                    {this.renderAvailable()}\n                  </select>\n                </div>\n              </div>\n              <div className=\"col-6\">\n                <div className=\"form-group\">\n                  <label htmlFor=\"\">Target Currency</label>\n                  <select\n                    name=\"type\"\n                    id=\"\"\n                    className=\"form-control\"\n                    value={this.state.target}\n                    onChange={(e) => this.setTarget(e.target.value)}\n                  >\n                    {this.renderAvailable()}\n                  </select>\n                </div>\n              </div>\n              {this.showRateTS()}\n              <div className=\"col\">Current Rate: {this.state.rate}</div>\n            </div>\n            <div className=\"row\">\n              <div className=\"col\">\n                <div className=\"form-group\">\n                  <label htmlFor=\"\">Amount (From)</label>\n                  <input\n                    type=\"number\"\n                    className=\"form-control\"\n                    value={this.state.amount}\n                    onChange={(e) => this.setAmount(e.target.value)}\n                  />\n                </div>\n              </div>\n              <div className=\"col\">\n                <div className=\"form-group\">\n                  <label htmlFor=\"\">Amount (To)</label>\n                  <input\n                    type=\"number\"\n                    className=\"form-control\"\n                    value={this.state.result}\n                    disabled\n                  />\n                </div>\n              </div>\n            </div>\n            <button className=\"btn btn-success\" type=\"submit\">\n              Convert\n            </button>\n          </form>\n        </div>\n      </div>\n    )\n  }\n}\nCurrency.propTypes = {\n  amount: PropTypes.number,\n}\n\nexport default Currency\n"]},"metadata":{},"sourceType":"module"}